(this.webpackJsonplauttanen=this.webpackJsonplauttanen||[]).push([[0],{121:function(e,t,n){e.exports=n(180)},126:function(e,t,n){},172:function(e,t,n){e.exports=n.p+"static/media/agency.d9438b70.txt"},173:function(e,t,n){e.exports=n.p+"static/media/calendar.0b493ac7.txt"},174:function(e,t,n){e.exports=n.p+"static/media/calendar_dates.9aefd69f.txt"},175:function(e,t,n){e.exports=n.p+"static/media/frequencies.16dfdd58.txt"},176:function(e,t,n){e.exports=n.p+"static/media/routes.20f1bb24.txt"},177:function(e,t,n){e.exports=n.p+"static/media/stop_times.ac2e9e5a.txt"},178:function(e,t,n){e.exports=n.p+"static/media/stops.013405fc.txt"},179:function(e,t,n){e.exports=n.p+"static/media/trips.9e713600.txt"},180:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(19),c=n.n(i),o=(n(126),n(127),n(128),n(129),n(130),n(21)),u=n(14),s=n(71),l=n(72),d=n(73),m=n(46);function p(e,t){var n=Object(m.a)(t,"yyyyMMdd"),a=t.getUTCDay(),r=e.calendar.filter((function(e){var t=e.start_date<=n&&n<=e.end_date,r=0===a&&"1"===e.sunday||1===a&&"1"===e.monday||2===a&&"1"===e.tuesday||3===a&&"1"===e.wednesday||4===a&&"1"===e.thursday||5===a&&"1"===e.friday||6===a&&"1"===e.saturday;return t&&r})).map((function(e){return e.service_id})),i=e.calendarDates.filter((function(e){return e.date===n&&"1"===e.exception_type})).map((function(e){return e.service_id})),c=e.calendarDates.filter((function(e){return e.date===n&&"2"===e.exception_type})).map((function(e){return e.service_id}));return function(e){for(var t=new Set(e),n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return a.forEach((function(e){return e.forEach((function(e){return t.delete(e)}))})),t}(function(){for(var e=new Set,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return n.forEach((function(t){return t.forEach((function(t){return e.add(t)}))})),e}(new Set(r),new Set(i)),new Set(c))}function f(e,t,n){return 60*e*60+60*t+n}function v(e){var t=e.split(":").map((function(e){return parseInt(e,10)})),n=Object(u.a)(t,3);return[n[0],n[1],n[2]]}var h,g=n(187),E=n(188);function b(e,t,n,a){var r,i=function(e,t,n,a){var r=e.tripStopFromToMap,i=Array.from(r["".concat(n,",").concat(a)]||[]),c=p(e,t),o=new Set;return i.forEach((function(t){return o.add(e.tripMap[t].service_id)})),i.map((function(t,n){var a=e.tripMap[t];return a&&c.has(a.service_id)?a:void 0})).filter(Boolean)}(e,t,n,a),c=f((r=t).getHours(),r.getMinutes(),r.getSeconds());return i.filter((function(t){return function(e){var t=v(e),n=Object(u.a)(t,3);return f(n[0],n[1],n[2])}(e.tripStopSequences[t.trip_id][0].departure_time)>=c}))}!function(e){e.ERROR="error",e.WAIT="wait",e.DRIVE="drive",e.FERRY="ferry"}(h||(h={}));var y=function(){function e(t,n,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(l.a)(this,e),this.interStopTravelMap=void 0,this.gtfsData=void 0,this.driveMultipliers=void 0,this.disembarkTimeMin=void 0,this.maxFerryOptions=5,this.gtfsData=t,this.interStopTravelMap=n,this.driveMultipliers=a,this.disembarkTimeMin=r}return Object(d.a)(e,[{key:"computeMultilegBitRecur",value:function(e,t){var n=this;if(!t.length)return[];var a=Object(s.a)(t),r=a[0],i=a.slice(1),c=Object(u.a)(r,2),o=c[0],l=c[1],d="".concat(o,",").concat(l),m=this.gtfsData.stopMap[o],p=this.gtfsData.stopMap[l];if(this.interStopTravelMap[d])return(i.length>0?this.driveMultipliers:[1]).map((function(t){var a=n.interStopTravelMap[d]*t,r=g.a(e,{minutes:a});return{id:"".concat(o,"-").concat(l,"-").concat(+e,"-").concat(+r),type:h.DRIVE,text:"".concat(m.stop_name," -> ").concat(p.stop_name),remark:1!==t?"".concat(t.toFixed(1),"x traffic adjustment"):void 0,startTime:e,endTime:r,startStopId:o,endStopId:l,next:n.computeMultilegBitRecur(r,i)}}));var f=b(this.gtfsData,e,o,l).slice(0,this.maxFerryOptions);return f.length?f.map((function(t){var a=n.gtfsData.tripStopSequences[t.trip_id],r=v(a[0].departure_time),c=Object(u.a)(r,3),s=c[0],d=c[1],m=c[2],p=v(a[1].arrival_time),f=Object(u.a)(p,3),b=f[0],y=f[1],x=f[2],O=E.a(e,{hours:s,minutes:d,seconds:m}),S=g.a(E.a(e,{hours:b,minutes:y,seconds:x}),{minutes:n.disembarkTimeMin});return{id:"".concat(t.trip_id),type:h.FERRY,text:t.trip_headsign,startTime:O,endTime:S,startStopId:o,endStopId:l,next:n.computeMultilegBitRecur(S,i)}})):[{id:"".concat(o,"-").concat(l,"-").concat(+e,"-error"),type:h.ERROR,text:"no valid route: ".concat(m.stop_name," -> ").concat(p.stop_name),startTime:e,endTime:e,startStopId:o,endStopId:l,next:[]}]}},{key:"computeMultileg",value:function(e,t){var n=this.computeMultilegBitRecur(e,function(e){for(var t=[],n=1;n<e.length;n++)t.push([e[n-1],e[n]]);return t}(t)),a={},r={};return n.forEach((function(e){return function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=r[t.id]=r[t.id]||new Set;n.forEach((function(e){return a.add(e.id)})),t.next.forEach((function(a){return e(a,[].concat(Object(o.a)(n),[t]))}))}(e)})),Object.keys(r).forEach((function(e){r[e].forEach((function(t){(a[t]=a[t]||new Set).add(e)}))})),{legs:n,legSuccessors:a,legPredecessors:r}}}]),e}(),x=n(189),O=n(3),S=n.n(O),T=n(185);function j(e){var t=e.leg,n=e.parentLeg,a=e.depth,i=e.accumulatedDuration,c=e.result,o=e.highlight,u=e.setHighlight,s=function(e){switch(e.type){case h.ERROR:return"\u26a1";case h.DRIVE:return"\ud83d\ude97";case h.FERRY:return"\ud83d\udea4";case h.WAIT:return"\u23f3"}return"???"}(t),l=n?x.a(t.startTime,n.endTime):void 0,d=x.a(t.endTime,t.startTime),p=(i||0)+d,f=0===t.next.length,v={initial:0===a,final:f};return o&&o!==t.id&&!c.legPredecessors[t.id].has(o)&&(v.faded=!0),o===t.id&&(v.highlight=!0),r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",{className:S()(v),onClick:function(){return u(o===t.id?void 0:t.id)}},r.a.createElement("td",{className:"dt st"},m.a(t.startTime,"HH:mm")),r.a.createElement("td",{className:"dt et"},m.a(t.endTime,"HH:mm")),r.a.createElement("td",{className:"dt du"},d," min"),r.a.createElement("td",{className:"dt wt"},void 0!==l&&l>0?"".concat(l," min"):null),r.a.createElement("td",{className:"tl"},s),r.a.createElement("td",{className:"tx"},r.a.createElement("div",{style:{paddingLeft:"".concat(a,"em")}},t.text,r.a.createElement("span",{className:"remark"},t.remark))),r.a.createElement("td",{className:"dt adu"},f?r.a.createElement(r.a.Fragment,null,p," min"):null)),t.next.map((function(n,i){return r.a.createElement(j,Object.assign({},e,{leg:n,parentLeg:t,key:i,depth:a+1,accumulatedDuration:p}))})))}function M(e){return r.a.createElement(T.g,{id:"t",interactive:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Start"),r.a.createElement("th",null,"End"),r.a.createElement("th",null,"Dur"),r.a.createElement("th",null,"Wait"),r.a.createElement("th",null,"Type"),r.a.createElement("th",null,"Description"),r.a.createElement("th",null,"Total Dur"))),r.a.createElement("tbody",null,e.result.legs.map((function(t,n){return r.a.createElement(j,Object.assign({},e,{leg:t,key:n,depth:0}))}))))}var D=n(77),k=(n(158),["changed","click","contextmenu","currentTimeTick","doubleClick","drop","groupDragged","itemout","itemover","mouseDown","mouseMove","mouseOver","mouseUp","rangechange","rangechanged","select","timechange","timechanged"]),w=function(e){var t=e.options,n=e.items,a=e.groups,i=e.eventHandlers,c=r.a.useRef(null),o=r.a.useRef(null),u=r.a.useRef(i);r.a.useEffect((function(){u.current=i}),[i]);var s=r.a.useCallback((function(e,t){var n=u.current;n&&e in n&&n[e](t)}),[]);return r.a.useEffect((function(){if(c.current){var e=o.current;e?(e.setOptions(t),e.setItems(n)):(e=new D.Timeline(c.current,n,t),k.forEach((function(t){return e&&e.on(t,(function(e){return s(t,e)}))})),o.current=e),e.setGroups(a)}return function(){o.current&&(o.current.destroy(),o.current=null)}}),[s,n,t,a,c]),r.a.createElement("div",{ref:c})},_={width:"100%",stack:!0,showCurrentTime:!0};function I(e){var t=e.gtfsData,n=e.result,a=e.highlight,i=e.setHighlight,c=n.legs,s=n.legPredecessors,l=r.a.useMemo((function(){var e={},n={},r={},i={};if(c.forEach((function(a){return function a(c,u){var l=c.id,d="".concat(c.startStopId,"-").concat(c.endStopId);if(!(d in n)){var m=t.stopMap[c.endStopId].stop_name;n[d]={id:d,content:"".concat(c.type," to ").concat(m)}}var p=r[l]=r[l]||{};i[l]=s[c.id],p[c.type]=!0,c.next.length||(p.final=!0),u.length||(p.initial=!0),e[l]={id:l,group:d,start:c.startTime,end:c.endTime,content:c.text},c.next.forEach((function(e){return a(e,[].concat(Object(o.a)(u),[[c,l]]))}))}(a,[])})),a)for(var u in e)u===a||i[u].has(a)||(r[u].faded=!0);for(var l in r)e[l]&&(e[l].className=S()(r[l]));return[Object(o.a)(Object.values(e)),Object(o.a)(Object.values(n))]}),[t.stopMap,c,s,a]),d=Object(u.a)(l,2),m=d[0],p=d[1];return r.a.createElement(w,{options:_,items:m,groups:p,eventHandlers:{select:function(e){var t=e.items;return i(t[0])}}})}var R=["1","3","4","29","6","24"],C={};[[["4","29"],30],[["6","24"],30],[["1","3"],45]].forEach((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1],r=Object(u.a)(n,2),i=r[0],c=r[1];C["".concat(i,",").concat(c)]=a,C["".concat(c,",").concat(i)]=a}));var B=n(24),F=n(186),H=n(83),N={formatDate:function(e){return m.a(e,"yyyy-MM-dd")},parseDate:function(e){return new Date(e)}};function A(e){var t=e.date,n=e.onChange;return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{flex:1}},r.a.createElement(F.a,Object.assign({},N,{showActionsBar:!0,value:t,onChange:function(e,t){return t?n(e):null}}))),r.a.createElement("div",{style:{flex:1}},r.a.createElement(H.a,{value:t,onChange:n})))}function P(e){var t=e.stopIds,n=e.setStopIds,a=e.gtfsData,i=e.driveTravelTimes,c=t.length?t[t.length-1]:null,s=function(e,t){var n=new Set;for(var a in e.tripStopSequences){var r=e.tripStopSequences[a];if(2===r.length){var i=Object(u.a)(r,2),c=i[0],o=i[1];null===t?n.add(c.stop_id):c.stop_id===t&&n.add(o.stop_id)}}return n}(a,c);c&&Object.keys(i).forEach((function(e){var t=e.split(","),n=Object(u.a)(t,2),a=n[0],r=n[1];a===c&&s.add(r)}));var l=r.a.createElement(T.f,{disabled:!s.size,onChange:function(e){var a=e.target.value;s.has(a)&&n(t.concat([a]))}},r.a.createElement("option",{value:""},"Add..."),Object(B.sortBy)(Array.from(s).map((function(e){return[e,a.stopMap[e].stop_name]})),1).map((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return r.a.createElement("option",{key:n,value:n},a)})));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,t.map((function(e,i){return r.a.createElement(T.q,{key:i,large:!0,onRemove:function(){return n(t.filter((function(t){return t!==e})))},style:{marginRight:".5em"}},a.stopMap[e].stop_name)}))),r.a.createElement("div",{style:{marginTop:".5em"}},l," ",r.a.createElement(T.a,{icon:"refresh",disabled:!t.length,onClick:function(){return n(Object(B.reverse)(Object(o.a)(t)))}},"Reverse")," ",r.a.createElement(T.a,{icon:"delete",disabled:!t.length,onClick:function(){return n([])}},"Clear")))}function q(e){return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(T.b,{style:{flex:1,margin:".5em"}},r.a.createElement(T.e,null,"Departure Time"),r.a.createElement(A,{date:e.date,onChange:e.onChangeDate})),r.a.createElement(T.b,{style:{flex:3,margin:".5em"}},r.a.createElement(T.e,null,"Route"),r.a.createElement(P,{stopIds:e.stopIds,setStopIds:e.setStopIds,gtfsData:e.gtfsData,driveTravelTimes:C})),r.a.createElement(T.b,{style:{flex:1,margin:".5em"}},r.a.createElement(T.e,null,"Options"),r.a.createElement(T.d,{label:"Disembarkation time (min)"},r.a.createElement(T.n,{min:0,max:20,stepSize:1,labelStepSize:5,onChange:e.setDisembarkTimeMin,value:e.disembarkTimeMin})),r.a.createElement(T.d,{label:"Drive time multiplier"},r.a.createElement(T.n,{min:0,max:2,stepSize:.1,labelStepSize:.5,onChange:e.setDriveTimeMultiplier,value:e.driveTimeMultiplier}))))}var z=n(52),L=n.n(z),G=n(79),V=n.n(G),W=n(80),Y=n.n(W);function J(e){var t=e.gtfsData,n=e.result.legs,a={},i={};function c(e,n){var r="",u="";r=n.length?n[n.length-1][2]:function(e){var n="stop-".concat(e);if(!a[n]){var r=t.stopMap[e];a[n]={data:{id:n,label:r.stop_name}}}return n}(e.startStopId),u="".concat(e.endStopId,"-").concat(e.endTime);var s=t.stopMap[e.endStopId];a[u]={data:{id:u,label:"".concat(s.stop_name," at ").concat(m.a(e.endTime,"HH:mm"))}};var l="".concat(r,"-").concat(u,"-").concat(e.startTime),d=x.a(e.endTime,e.startTime),p=n.length?n[n.length-1][0]:void 0,f=p?x.a(e.startTime,p.endTime):void 0,v=(f?"".concat(f,"min wait, "):"")+"".concat(d,"min ").concat(e.type);i[l]={data:{id:l,source:r,target:u,label:v},classes:"".concat(e.type)},e.next.forEach((function(t){return c(t,[].concat(Object(o.a)(n),[[e,r,u]]))}))}return n.forEach((function(e){return c(e,[])})),r.a.createElement(Y.a,{elements:[].concat(Object(o.a)(Object.values(a)),Object(o.a)(Object.values(i))),stylesheet:[{selector:"node",style:{label:"data(label)"}},{selector:"edge",style:{label:"data(label)","curve-style":"straight"}},{selector:"edge.ferry",style:{"line-color":"navy"}}],layout:{name:"klay",nodeDimensionsIncludeLabels:!0,klay:{direction:"RIGHT",edgeRouting:"SPLINES"}},style:{width:"100%",height:"600px",border:"1px solid orange"}})}L.a.use(V.a);var U=n(28),K=n.n(U),Q=n(36),X=n(82),Z=n(81),$=n.n(Z);function ee(){return(ee=Object(Q.a)(K.a.mark((function e(t){var n,a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.keys(t).map(function(){var e=Object(Q.a)(K.a.mark((function e(n){var a,r,i,c;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t[n]);case 2:if((r=e.sent).ok){e.next=5;break}throw new Error(r.statusText);case 5:return e.next=7,r.text();case 7:return i=e.sent.replace(/[\r\n]+/g,"\n").trim(),c=$.a.parse(i,{header:!0}),(null===(a=c.errors)||void 0===a?void 0:a.length)&&console.warn(n,c.errors),e.abrupt("return",[n,c.data]);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=3,Promise.all(n);case 3:return a=e.sent,e.abrupt("return",Object.fromEntries(a));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){var t=Object(B.groupBy)(e.stopTimes,(function(e){return e.trip_id})),n=function(e){var t={};for(var n in e){var a=e[n];if(2===a.length){var r=Object(u.a)(a,2),i=r[0],c=r[1],o="".concat(i.stop_id,",").concat(c.stop_id);t[o]||(t[o]=new Set),t[o].add(n)}}return t}(t);return Object(X.a)({},e,{routeMap:Object(B.keyBy)(e.routes,"route_id"),stopMap:Object(B.keyBy)(e.stops,"stop_id"),tripMap:Object(B.keyBy)(e.trips,"trip_id"),tripStopSequences:t,tripStopFromToMap:n})}function ne(e,t){return t&&function(e,t){var n=Object(m.a)(t,"yyyyMMdd");e.calendarDates=e.calendarDates.filter((function(e){return e.date>=n})),e.calendar=e.calendar.filter((function(e){return e.end_date>=n}))}(e,t),te(e)}function ae(){return function(e){return ee.apply(this,arguments)}({agency:n(172),calendar:n(173),calendarDates:n(174),frequencies:n(175),routes:n(176),stopTimes:n(177),stops:n(178),trips:n(179)})}function re(){return(re=Object(Q.a)(K.a.mark((function e(){var t;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae();case 2:return t=e.sent,e.abrupt("return",ne(t,new Date(2020,0)));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e){return r.a.createElement(T.p,{id:e.id,renderActiveTabPanelOnly:!0},r.a.createElement(T.o,{id:"timeline",title:"Timeline",panel:r.a.createElement(I,e.viewProps)}),r.a.createElement(T.o,{id:"table",title:"Table",panel:r.a.createElement(M,e.viewProps)}),r.a.createElement(T.o,{id:"graph",title:"Graph",panel:r.a.createElement(J,e.viewProps)}),e.renderButton?r.a.createElement(r.a.Fragment,null,r.a.createElement(T.p.Expander,null),r.a.createElement(T.a,{icon:"split-columns",active:e.buttonActive,onClick:e.onButtonClick},"Split")):null)}function ce(e){var t=e.gtfsData,n=r.a.useState(),a=Object(u.a)(n,2),i=a[0],c=a[1],s=r.a.useState((function(){return new Date})),l=Object(u.a)(s,2),d=l[0],p=l[1],f=r.a.useState((function(){return Object(o.a)(R)})),v=Object(u.a)(f,2),h=v[0],g=v[1],E=r.a.useState(3),b=Object(u.a)(E,2),x=b[0],O=b[1],S=r.a.useState(1.5),j=Object(u.a)(S,2),M=j[0],D=j[1],k=r.a.useState(!1),w=Object(u.a)(k,2),_=w[0],I=w[1],F=r.a.useMemo((function(){return new y(t,C,Object(B.uniq)([1,M]),x)}),[t,x,M]),H=r.a.useMemo((function(){return F.computeMultileg(d,h)}),[F,d,h]),N={gtfsData:t,result:H,highlight:i,setHighlight:c},A=H.legs.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,m.a(d,"dd.MM.yyyy HH:mm"),r.a.createElement("br",null),h.map((function(e){return t.stopMap[e]})).map((function(e){return e.stop_name})).join(" - ")),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{flex:1}},r.a.createElement(ie,{id:"tabs1",viewProps:N,renderButton:!0,buttonActive:_,onButtonClick:function(){return I(!_)}})),_?r.a.createElement("div",{style:{flex:1}},r.a.createElement(ie,{id:"tabs2",viewProps:N})):null)):r.a.createElement(T.l,{icon:"search",title:"No results"});return r.a.createElement("div",{className:"App"},r.a.createElement(q,{date:d,onChangeDate:p,stopIds:h,setStopIds:g,gtfsData:t,setDisembarkTimeMin:O,disembarkTimeMin:x,setDriveTimeMultiplier:function(e){return D(parseFloat(e.toFixed(2)))},driveTimeMultiplier:M}),A)}var oe=function(){var e=r.a.useState(),t=Object(u.a)(e,2),n=t[0],a=t[1];return r.a.useEffect((function(){(function(){return re.apply(this,arguments)})().then(a)}),[]),void 0===n?null:r.a.createElement(ce,{gtfsData:n})};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(oe,null)),document.getElementById("root"))}},[[121,1,2]]]);
//# sourceMappingURL=main.6adf793c.chunk.js.map